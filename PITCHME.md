### カスタムフィルタを階層化して<br>テンプレートエンジンを使い倒す
[@cuhey3](http://twitter.com/cuhey3)

---

### 自己紹介

<small>
 
- 20代はニート兼フリーターをして過ごす
- 30から3年間、事務の会社でDIY的に業務アプリを作って過ごす
- 34でIT業界デビュー
- 35でフロントエンドリード（現職）

</small>

---

### ・・・IT業界って人手不足ですね！

---

### テンプレートエンジン、<br>使ってますか？

---

### そもそもテンプレートエンジンって？

<br>

- テンプレート文字列に、変数を流し込んで<br>HTMLを生成するライブラリ
- それ以上でもそれ以下でもない


---

### テンプレートエンジンのイメージ

<br>

- 時代遅れ
- HTMLを生成するだけ
- 拡張性が低い、思うように書けない


---

### ・・・だいたい合ってる

---

### テンプレートエンジンが向くケース

<br>

- ページ表示後のインタラクションが限られる時
- サーバーサイドレンダリングが前提の時
 - 隠蔽したいロジックがある時
- SPAフレームワーク採用が人員的に厳しい時

---

### テンプレートエンジン選定のポイント

<small>
本格的に使用をはじめる前に確認しておこう！
<br>
フレームワーク標準のものが
<br>機能的に十分とは限らないぞ！
</small>
---

### ポイントその１

#### コンテンツテンプレートから、<br>レイアウトテンプレートを呼び出せること

<br>
<small>レイアウトを必ず先に呼ぶ必要があるライブラリは、<br>
サーバーサイドレンダリングとは相性が悪いです。<br>
(最悪ハマります。)</small>

---

### ポイントその２

#### HTML断片を返す子テンプレートを<br>自作できること

<br>
<small>
こちらの機能は普通はあります。
<br>任意のタイプを引数に取れると尚可
</small>

---

### ポイントその３

#### テンプレート上で呼び出せる関数を<br>自作できること

<br>
<small>
関数は任意のタイプの引数を受け取ることができて、<br>また任意のタイプを返却できると捗る。
</small>

---

### テンプレート関数を自作しよう

---

### 使用するテンプレートエンジン

---

Nunjucks
<small>

- 公式 [https://mozilla.github.io/nunjucks/](https://mozilla.github.io/nunjucks/)
- mozilla謹製
- jinja2系
- テンプレートから呼び出す関数は[フィルタ](https://mozilla.github.io/nunjucks/templating.html#filters)と呼ばれる

</small>

--- 

フィルタの使用イメージ

Input

```
{{ "abcdef" | reverse }}
```

Output

```
fedcba
```

---

フィルタの使用イメージその２

Input

```
{% for i in [1, 2, 3, 4] | reverse %}
  {{ i }}
{% endfor %}
```

Output

```
4 3 2 1
```

---

### フィルタの自作（カスタムフィルタ）

<small>
基本的な作り方は下記リンクの通りです。
<br>Custom-filters<br>[https://mozilla.github.io/nunjucks/api#custom-filters](https://mozilla.github.io/nunjucks/api#custom-filters)
</small>
